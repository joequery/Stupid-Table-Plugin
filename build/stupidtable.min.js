(function(){$(function(){return $.fn.stupidtable=function(a){return this.each(function(){var b,c,d,e,f,g;return b=$(this),d=b.data("default-sort-th"),e=d?b.find("th#"+d):null,a=a||{},a=$.extend({},$.fn.stupidtable.default_sort_fns,a),f=function(a,b,c){var d,e,f,g,h,i,j,k;if(f=[],e=0,c)for(d=h=j=a.length-1;h>=0;d=h+=-1)f.push(d);else for(g=a.slice(0).sort(b),d=i=0,k=a.length-1;k>=0?k>=i:i>=k;d=k>=0?++i:--i){for(e=$.inArray(a[d],g);-1!==$.inArray(e,f);)e++;f.push(e)}return f},c=function(a,b){var c,d,e,f,g;for(c=a.slice(0),e=0,d=f=0,g=b.length-1;g>=0?g>=f:f>=g;d=g>=0?++f:--f)e=b[d],c[e]=a[d];return c},g=function(d,e){var g,h,i,j,k,l;return k=b.children("tbody").children("tr"),g=d,j=0,h=$.fn.stupidtable.dir,b.find("th").slice(0,g.index()).each(function(){var a;return a=$(this).attr("colspan")||1,j+=parseInt(a,10)}),i=e?b.data("default-sort-dir")||h.ASC:g.data("sort-dir")===h.ASC?h.DESC:h.ASC,l=i===h.DESC?g.data("sort-desc")||g.data("sort")||null:g.data("sort")||null,null!==l?(b.trigger("beforetablesort",{column:j,direction:i}),b.css("display"),setTimeout(function(){var d,h,m,n,o;return d=[],m=a[l],k.each(function(a,b){var c,e,f;return c=$(b).children().eq(j),f=c.data("sort-value"),e="undefined"!=typeof f?f:c.text(),d.push(e)}),h=!!g.data("sort-dir")&&!g.data("sort-desc")&&!e,o=f(d,m,h),b.find("th").data("sort-dir",null).removeClass("sorting-desc sorting-asc"),g.data("sort-dir",i).addClass("sorting-"+i),n=$(c(k,o)),e&&"desc"===i&&(n=n.toArray().reverse(),n=$(n)),b.children("tbody").append(n),b.trigger("aftertablesort",{column:j,direction:i}),b.css("display")},10)):void 0},b.on("click","th",function(){return g($(this),!1)}),e&&1===e.length?g(e,!0):void 0})},$.fn.stupidtable.dir={ASC:"asc",DESC:"desc"},$.fn.stupidtable.default_sort_fns={"int":function(a,b){return parseInt(a,10)-parseInt(b,10)},"float":function(a,b){return parseFloat(a)-parseFloat(b)},string:function(a,b){return b>a?-1:a>b?1:0},"string-ins":function(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),b>a?-1:a>b?1:0}}})}).call(this);