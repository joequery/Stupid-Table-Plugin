!function(a){a.fn.stupidtable=function(b){return this.each(function(){var c=a(this),d=c.data("default-sort-th"),e=d?c.find("th#"+d):null;b=b||{},b=a.extend({},a.fn.stupidtable.default_sort_fns,b);var f=function(b,c,d){var e=[],f=0;if(d)for(var g=b.length-1;g>=0;g--)e.push(g);else for(var h=b.slice(0).sort(c),g=0;g<b.length;g++){for(f=a.inArray(b[g],h);-1!=a.inArray(f,e);)f++;e.push(f)}return e},g=function(a,b){for(var c=a.slice(0),d=0,e=0;e<b.length;e++)d=b[e],c[d]=a[e];return c},h=function(d){var e=c.children("tbody").children("tr"),h=d,i=0,j=a.fn.stupidtable.dir;c.find("th").slice(0,h.index()).each(function(){var b=a(this).attr("colspan")||1;i+=parseInt(b,10)});var k=h.data("sort-dir")===j.ASC?j.DESC:j.ASC;if(k==j.DESC)var l=h.data("sort-desc")||h.data("sort")||null;else var l=h.data("sort")||null;null!==l&&(c.trigger("beforetablesort",{column:i,direction:k}),c.css("display"),setTimeout(function(){var d=[],j=b[l];e.each(function(b,c){var e=a(c).children().eq(i),f=e.data("sort-value"),g="undefined"!=typeof f?f:e.text();d.push(g)});var m=!!h.data("sort-dir")&&!h.data("sort-desc"),n=f(d,j,m);c.find("th").data("sort-dir",null).removeClass("sorting-desc sorting-asc"),h.data("sort-dir",k).addClass("sorting-"+k);var o=a(g(e,n));c.children("tbody").append(o),c.trigger("aftertablesort",{column:i,direction:k}),c.css("display")},10))};c.on("click","th",function(){h(a(this))}),e&&1==e.length&&h(e)})},a.fn.stupidtable.dir={ASC:"asc",DESC:"desc"},a.fn.stupidtable.default_sort_fns={"int":function(a,b){return parseInt(a,10)-parseInt(b,10)},"float":function(a,b){return parseFloat(a)-parseFloat(b)},string:function(a,b){return b>a?-1:a>b?1:0},"string-ins":function(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),b>a?-1:a>b?1:0}}}(jQuery);