(function(e){e.fn.stupidtable=function(t){return this.each(function(){var n=e(this);t=t||{};t=e.extend({},e.fn.stupidtable.default_sort_fns,t);n.data("sortFns",t);n.on("click.stupidtable","thead th",function(){var t=e(this);var r=0;var i=e.fn.stupidtable.dir;t.parents("tr").find("th").slice(0,t.index()).each(function(){var t=e(this).attr("colspan")||1;r+=parseInt(t,10)});var s=t.data("sort-default")||i.ASC;if(t.data("sort-dir"))s=t.data("sort-dir")===i.ASC?i.DESC:i.ASC;e.fn.stupidtable.sortByColumn.call(n,r,s)})})};e.fn.stupidtable.sortByColumn=function(t,n){var r=e(this);var i=e.fn.stupidtable.getColumnByIndex.call(r,t);if(i===null){return}var s=e.fn.stupidtable.dir;var o=r.data("sortFns");var u=i.data("sort")||null;if(u===null){return}r.trigger("beforetablesort",{column:t,direction:n});r.css("display");setTimeout(function(){var a=[];var f=o[u];var l=r.children("tbody").children("tr");l.each(function(n,r){var i=e(r).children().eq(t);var s=i.data("sort-value");var o=typeof s!=="undefined"?s:i.text();a.push([o,r])});a.sort(function(e,t){return f(e[0],t[0])});if(n!=s.ASC)a.reverse();l=e.map(a,function(e){return e[1]});r.children("tbody").append(l);r.find("th").data("sort-dir",null).removeClass("sorting-desc sorting-asc");i.data("sort-dir",n).addClass("sorting-"+n);r.trigger("aftertablesort",{column:t,direction:n});r.css("display")},10)};e.fn.stupidtable.getColumnByIndex=function(t){var n=e(this);var r=null;var i=0;var s=false;n.find("thead th").each(function(){if(i>=t&&!s){s=true;r=e(this)}var n=e(this).attr("colspan")||1;i+=parseInt(n,10)});return r};e.fn.stupidtable.remove=function(){var t=e(this);t.data("sortFns",null);t.off("click.stupidtable","thead th")};e.fn.stupidtable.dir={ASC:"asc",DESC:"desc"};e.fn.stupidtable.default_sort_fns={"int":function(e,t){return parseInt(e,10)-parseInt(t,10)},"float":function(e,t){return parseFloat(e)-parseFloat(t)},string:function(e,t){return e.localeCompare(t)},"string-ins":function(e,t){e=e.toLocaleLowerCase();t=t.toLocaleLowerCase();return e.localeCompare(t)}}})(jQuery)
