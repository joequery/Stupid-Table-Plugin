(function(e){e.fn.stupidtable=function(t){return this.each(function(){var n=e(this);var r=n.data("default-sort-th");var i=r?n.find("th#"+r):null;t=t||{};t=e.extend({},e.fn.stupidtable.default_sort_fns,t);var s=function(t,n,r){var i=[];var s=0;if(r){for(var o=t.length-1;o>=0;o--){i.push(o)}}else{var u=t.slice(0).sort(n);for(var o=0;o<t.length;o++){s=e.inArray(t[o],u);while(e.inArray(s,i)!=-1){s++}i.push(s)}}return i};var o=function(e,t){var n=e.slice(0),r=0;for(var i=0;i<t.length;i++){r=t[i];n[r]=e[i]}return n};var u=function(r){var i=n.children("tbody").children("tr");var u=r;var a=0;var f=e.fn.stupidtable.dir;n.find("th").slice(0,u.index()).each(function(){var t=e(this).attr("colspan")||1;a+=parseInt(t,10)});var l=u.data("sort-dir")===f.ASC?f.DESC:f.ASC;if(l==f.DESC)var c=u.data("sort-desc")||u.data("sort")||null;else var c=u.data("sort")||null;if(c===null){return}n.trigger("beforetablesort",{column:a,direction:l});n.css("display");setTimeout(function(){var r=[];var f=t[c];i.each(function(t,n){var i=e(n).children().eq(a);var s=i.data("sort-value");var o=typeof s!=="undefined"?s:i.text();r.push(o)});var h=!!u.data("sort-dir")&&!u.data("sort-desc");var p=s(r,f,h);n.find("th").data("sort-dir",null).removeClass("sorting-desc sorting-asc");u.data("sort-dir",l).addClass("sorting-"+l);var d=e(o(i,p));n.children("tbody").append(d);n.trigger("aftertablesort",{column:a,direction:l});n.css("display")},10)};n.on("click","th",function(){u(e(this))});if(i&&i.length==1)u(i)})};e.fn.stupidtable.dir={ASC:"asc",DESC:"desc"};e.fn.stupidtable.default_sort_fns={"int":function(e,t){return parseInt(e,10)-parseInt(t,10)},"float":function(e,t){return parseFloat(e)-parseFloat(t)},string:function(e,t){if(e<t)return-1;if(e>t)return+1;return 0},"string-ins":function(e,t){e=e.toLowerCase();t=t.toLowerCase();if(e<t)return-1;if(e>t)return+1;return 0}}})(jQuery)